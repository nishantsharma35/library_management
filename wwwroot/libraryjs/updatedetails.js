$(document).ready(function () {    $('#imgInp').on('change', function (event) {        const file = event.target.files[0];        if (file) {            const reader = new FileReader();            reader.onload = function (e) {                $('#previewImg').attr('src', e.target.result);            };            reader.readAsDataURL(file);        }    });    fetch(`/Dashboard/states`)        .then(response => {            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);            return response.json();        })        .then(data => {            const states = data.geonames;            let stateOptions = `<option value="">Select State</option>`;            states.forEach(state => {                const selectedState = $("#selectedState").val();                const selected = state.name === selectedState ? "selected" : "";                stateOptions += `<option value="${state.name}" data-id="${state.geonameId}" ${selected}>${state.name}</option>`;            });            $("#State").html(stateOptions).trigger("change"); // trigger to load cities        })        .catch(error => {            console.error("Error fetching states:", error);        });    // Fetch Cities when a state is selected    $("#State").on("change", function () {        const selectedStateGeonameId = $(this).find("option:selected").data("id");        if (selectedStateGeonameId) {            fetch(`/Dashboard/cities/${selectedStateGeonameId}`)                .then(response => {                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);                    return response.json();                })                .then(data => {                    const cities = data.geonames;                    const selectedCity = $("#selectedCity").val();                    let cityOptions = `<option value="">Select City</option>`;                    cities.forEach(city => {                        const selected = city.name === selectedCity ? "selected" : "";                        cityOptions += `<option value="${city.name}" data-id="${city.geonameId}" ${selected}>${city.name}</option>`;                    });                    $("#City").html(cityOptions);                })                .catch(error => {                    console.error("Error fetching cities:", error);                });        } else {            $("#City").html(`<option value="">Select City</option>`);        }    });    $("#UpdateDetails").validate({        submitHandler: function (form, event) {            event.preventDefault()            const formData = new FormData(form);                       const btnRegister = $("#btnSubmit");            const btnLoader = $("#btnLoader");            btnRegister.prop("disabled", true);            btnLoader.removeClass("d-none");                // AJAX submission                $.ajax({                    url: '/Dashboard/MyProfile',                    type: 'POST',                    processData: false,                    contentType: false,                    data: formData,                    success: function (result) {                        console.log("Success block hit:", result);                        showToast(result.message, "success");                        if (result.success) {                            setTimeout(() => {
                                    window.location.href = '/Dashboard';                            }, 1500);                        }                    },                    complete: function () {                        // Re-enable button and hide loader                        btnRegister.prop("disabled", false);                        btnLoader.addClass("d-none");                    },                    error: function () {                        showToast('An error occurred while registering the user.');                    }                });                
        }    });});